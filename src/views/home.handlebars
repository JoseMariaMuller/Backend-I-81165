<h1 class="mb-4">Productos Disponibles</h1>

{{#if products}}
<!-- Cards de productos -->
<div class="row row-cols-1 row-cols-md-3 g-4">
    {{#each products}}
    <div class="col">
        <div class="card h-100 shadow-sm">
            <div class="card-body d-flex flex-column">
                <h5 class="card-title">{{this.title}}</h5>
                <p class="card-text">{{this.description}}</p>
                <div class="mt-auto">
                    <span class="badge bg-primary">Stock: {{this.stock}}</span>
                    <span class="badge bg-secondary">Código: {{this.code}}</span>
                    <p class="fs-5 fw-bold text-primary mt-2">$ {{this.price}}</p>
                    <button class="btn btn-danger btn-sm mt-2" onclick="deleteProduct('{{this._id}}')">
                        Eliminar
                    </button>
                </div>
            </div>
        </div>
    </div>
    {{/each}}
</div>

<!-- Paginación -->
{{#if links}}
<nav aria-label="Paginación" class="mt-4">
    <ul class="pagination justify-content-center">
        <!-- Página anterior -->
        {{#if hasPrevPage}}
        <li class="page-item">
            <a class="page-link" href="{{prevLink}}" aria-label="Anterior">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
        {{else}}
        <li class="page-item disabled">
            <span class="page-link">&laquo;</span>
        </li>
        {{/if}}

        <!-- Enlaces de páginas -->
        {{#each links}}
        <li class="page-item {{#if active}}active{{/if}}">
            <a class="page-link" href="{{this.link}}">{{this.text}}</a>
        </li>
        {{/each}}

        <!-- Página siguiente -->
        {{#if hasNextPage}}
        <li class="page-item">
            <a class="page-link" href="{{nextLink}}" aria-label="Siguiente">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        {{else}}
        <li class="page-item disabled">
            <span class="page-link">&raquo;</span>
        </li>
        {{/if}}
    </ul>
</nav>
{{/if}}

{{else}}
<p class="text-center">No hay productos disponibles.</p>
{{/if}}

<script>
    function deleteProduct(id) {
        if (confirm('¿Eliminar este producto?')) {
            fetch(`/api/products/${id}`, { method: 'DELETE' })
                .then(() => window.location.reload())
                .catch(err => console.error(err));
        }
    }
</script>